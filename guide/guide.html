<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width">




<title>PDF Document Maker - User Guide</title>





 
 
 
 













<meta name="pagename" content="PDF Document Maker - User Guide">











<meta name="DC.title" content="PDF Document Maker - User Guide">














<!-- OpenGraph Meta Tags -->

<meta name="og:title" content="PDF Document Maker - User Guide">

<meta name="og:url" content="https://akashacms.github.io/pdf-document-construction-set/guide/guide.html">


































<link rel="canonical" href="https://akashacms.github.io/pdf-document-construction-set/guide/guide.html">


<link rel="sitemap" type="application/xml" href="../sitemap.xml" title="Sitemap">









<link rel="stylesheet" type="text/css" href="../vendor/katex/dist/katex.min.css"><link rel="stylesheet" type="text/css" href="../vendor/markdown-it-texmath/css/texmath.css"><link rel="stylesheet" type="text/css" href="../vendor/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="../vendor/bootstrap/css/bootstrap-theme.min.css"><link rel="stylesheet" type="text/css" href="../vendor/highlight.js/styles/stackoverflow-dark.css"><link rel="stylesheet" type="text/css" href="../style.css">



</head>
<body>

<nav class="navbar fixed-top navbar-expand-md navbar-light bg-light">
    <a class="navbar-brand" href="../index.html">PDF Document Maker</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarText">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link" href="../index.html">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="index.html">Guide</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="../blog/index.html">News</a>
            </li>
        </ul>
    </div>
</nav>

<!-- partial file-name="site-navbar.html"></partial -->

<div class="container" role="main">
<div class="row">

<!-- partial file-name="header.html"></partial -->
</div>

<div class="row">
  <section id="breadcrumb" class="col-sm-12">
    <div id="breadcrumbTrail">
    
        &#xbb; <a class="p-category" href="../index.html">PDF Document Maker</a>
    
        &#xbb; <a class="p-category" href="index.html">PDF Document Maker Guide</a>
    
        &#xbb; <a class="p-category" href="guide.html">PDF Document Maker - User Guide</a>
    
</div>

  </section>
</div>
<!-- 
<div class="row">
  <section id="byline" class="col-sm-12">
    <publication-date></publication-date>;
  </section>
</div>
-->

<div class="row">
  <article class="col-sm-12">
    <div class="article-heading">
        <h1 class="article-title" align="center">PDF Document Maker - User Guide
    </h1></div>

    
    <div class="row ml-auto mr-auto text-center">
<figure class="ml-auto mr-auto">
<img src="../logo-pdf-document-maker.png" class="ml-auto mr-auto" alt="PDF Document Maker">
</figure>
</div>
<p class="text-center">Version: 1.0.1</p>
<p class="text-center">Publication Date: January 27, 2025</p>
<p class="text-center">Written by: David Herron</p>
<p class="text-center">Home page: <a href="https://akashacms.github.io/pdf-document-construction-set/index.html">https://akashacms.github.io/pdf-document-construction-set/index.html</a></p>
<p><em>PDF Document Maker</em> is a comprehensive tool for producing good quality PDFs from Markdown or AsciiDoc files.</p>
<p>The goal is producing documents with similar fidelity to those produced from WYSIWYG word processors, from files which are easily versioned in normal source code control systems (like Git).  A secondary goal is the ability to easily use the same content, as normal HTML pages, on a website.</p>
<p>The features include</p>
<ul>
<li>Many Markdown extensions adding useful capaibilities</li>
<li>Formatting templates covering both page layout and custom HTML snippets</li>
<li>Using multiple CSS stylesheets to customize the look.  The tool comes with one stylesheet designed specifically for printable documents</li>
<li>Both custom DOM processing and custom HTML elements, supporting custom design elements, and even bringing in external data</li>
<li>Built on top of AkashaCMS, a mature system that&apos;s designed for producing static HTML websites and E-Books.</li>
<li>HTML intermediary files are converted to PDF using Puppeteer</li>
</ul>
<p>All this is bundled into one easy-to-use command-line application offering a lot of flexibility.</p>
<p>This document</p>
<ul>
<li>Documents PDF Document Maker usage</li>
<li>Serves as an example document rendered to PDF using PDF Document Maker</li>
<li>Serves as a testbed for PDF Document Maker features</li>
<li>Demonstrates reusing the same content between PDF and Website</li>
</ul>
<p>This document is rendered from a project directory in the GitHub repository: <a href="https://github.com/akashacms/pdf-document-construction-set/tree/main/guide">https://github.com/akashacms/pdf-document-construction-set/tree/main/guide</a></p>
<p><toc-text-here></toc-text-here></p>
<section>
<h1>Installation and Project setup for PDF Document Maker</h1>
<p>PDF Document Maker runs on the Node.js platform, and is tested with Node.js v20.  It should work for later releases.</p>
<p>A project directory consists of a <em>package.json</em> file which is used for listing dependencies and build processes.  Instead of being used for building Node.js packages, we will use it to record project dependencies and for build scripts.</p>
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">node --version  <span class="hljs-comment"># Make sure v20 or later</span></span>
<span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npm init -y     <span class="hljs-comment"># Set up a default package.json</span></span>
<span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npm install @akashacms/pdf-document-maker --save</span>
</code></pre>
<p>Once installed you can get help:</p>
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npx pdf-document-maker --<span class="hljs-built_in">help</span></span>
Usage: pdf-document-maker [options] &lt;docPath&gt;

CLI to build PDF files from Markdown/AsciiDoc documents
<span class="hljs-meta prompt_">  # </span><span class="language-bash">...</span>
  -h, --help                        display help for command
</code></pre>
<p>The application has a lot of options.  But, most of them have reasonable defaults, and typically you&apos;ll use only a few.</p>
</section>
<section>
<h1>Quick start for using PDF Document Maker</h1>
<p>Before going deep into using PDF Document Maker, let&apos;s do a quick and easy example.  We will format a test file into a PDF.</p>
<p>The search phrase &quot;<em>standard markdown test file</em>&quot; turns up several test Markdown files.  This repository has a very good one:   <a href="https://github.com/mxstbr/markdown-test-file"><code>https://github.com/mxstbr/markdown-test-file</code></a></p>
<p>Start by creating a directory, adding a <code>package.json</code>, and installing <code>@akashacms/pdf-document-maker</code> as shown above.</p>
<p>The GitHub repository for this tool already has this set up in <a href="https://github.com/akashacms/pdf-document-construction-set/tree/main/example/simple"><code>https://github.com/akashacms/pdf-document-construction-set/tree/main/example/simple</code></a></p>
<p>In that directory, create a directory named <code>documents</code>:</p>
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash"><span class="hljs-built_in">mkdir</span> documents</span>
<span class="hljs-meta prompt_">&#x24; </span><span class="language-bash"><span class="hljs-built_in">cd</span> documents</span>
<span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">wget https://...   <span class="hljs-comment"># Download TEST.md</span></span>
<span class="hljs-meta prompt_">&#x24; </span><span class="language-bash"><span class="hljs-built_in">cd</span> ..</span>
</code></pre>
<p>With a file, <code>documents/TEST.md</code>, run this command:</p>
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npx pdf-document-maker  \
        --document-dir documents \
        --pdf-output PDF \
        --html-output out \
        --title <span class="hljs-string">&apos;Markdown test document&apos;</span> \
        --format A4 \
        TEST.md</span>
</code></pre>
<p>This command creates two files:</p>
<ul>
<li><code>out/TEST.html</code> - is the HTML intermediate file</li>
<li><code>PDF/TEST.pdf</code> - is the PDF result</li>
</ul>
<section>
<h2>What did that command do?</h2>
<p>A lot happened under the covers:</p>
<ul>
<li>A configuration object was built for rendering documents into an HTML output directory.</li>
<li>The input file was processed and written to the output, as were any assets (CSS etc).
<ul>
<li>This created <code>out/TEST.html</code></li>
</ul>
</li>
<li>Puppeteer was invoked to print the HTML to PDF.
<ul>
<li>This created <code>PDF/TEST.pdf</code></li>
</ul>
</li>
</ul>
<p>This is approximately what happened:</p>

        <figure>
        <img src="img/activity-diagram-1.png">
        
        </figure>
        
<p>This diagram is itself an example of what&apos;s possible.  This is a UML Activity Diagram describing a high-level overview of <em>PDF Document Maker</em>&apos;s internal implementation.  The diagram is described in-line with the text, then formatted using PlantUML into a PNG.</p>
<p>This diagram names four kinds of directories.  This comes from the underlying system, AkashaCMS, which supports four sets of input directories, <em>assets</em>, <em>partials</em>, <em>layouts</em>, and <em>documents</em> with these purposes.</p>
<table class="table">
<caption>Table 1. Directory types</caption>
<thead>
<tr>
<th>Type</th>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>assets</em></td>
<td><code>--asset-dir</code></td>
<td>Holds unprocessed files like CSS or images</td>
</tr>
<tr>
<td><em>partials</em></td>
<td><code>--partial-dir</code></td>
<td>Holds templates for content snippets</td>
</tr>
<tr>
<td><em>layouts</em></td>
<td><code>--layout-dir</code></td>
<td>Holds page layout templates</td>
</tr>
<tr>
<td><em>documents</em></td>
<td><code>--document-dir</code></td>
<td>Holds document files</td>
</tr>
</tbody>
</table>
<p>For of the directory types there may be multiple actual directories.  The directories are <em>stacked</em> with the later directories being higher in the stack.  This forms four virtual filesystems and we refer to files using the relative pathname from the root.</p>
<p>In this example there is one documents directory.  The file <code>TEST.md</code> was placed in that directory, giving it the file-system path <code>documents/TEST.md</code>.  Because it is a file in a documents directory, it has a VPath (Virtual Path) of <code>TEST.md</code> which is the path we use on the command line.</p>
<p>No page layout template was named on the command-line.  Within PDF Document Maker there is a <code>layouts</code> directory holding a single layout template, <code>default.njk</code>, which is used by default if no layout template is specified.</p>
<p>By default a print-oriented CSS stylesheet is used.</p>
<p>Look in the directory <code>out</code> and you&apos;ll find several files including <code>TEST.html</code>, which was rendered from <code>TEST.md</code>.</p>
</section>
</section>
<section>
<h1>File name conventions</h1>
<p>We already discussed how the virtual directory stack works, and that a VPath is a path name relative to the root directory(ies).</p>
<p>The file names in <em>documents</em>, <em>partials</em>, and <em>layouts</em> directories have file extensions naming the file type.  The extension is used to select the rendering package required to process that file.</p>
<table class="table">
<caption>Table 2. Renderable file types</caption>
<thead>
<tr>
<th>Name</th>
<th>Extension</th>
<th>Output Ext</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AsciiDoc</td>
<td><code>.adoc</code> or <code>.html.adoc</code></td>
<td><code>.html</code></td>
<td>Supports AsciiDoctor documents</td>
</tr>
<tr>
<td>Markdown</td>
<td><code>.md</code> or <code>.html.md</code></td>
<td><code>.html</code></td>
<td>Supports Markdown documents</td>
</tr>
<tr>
<td>LESS</td>
<td><code>.less</code> or <code>.css.less</code></td>
<td><code>.css</code></td>
<td>Supports compiling LESS files to CSS</td>
</tr>
<tr>
<td>EJS</td>
<td><code>.ejs</code> or <code>.html.ejs</code></td>
<td><code>.html</code></td>
<td>EJS</td>
</tr>
<tr>
<td>Handlebars</td>
<td><code>.handlebars</code> or <code>.html.handlebars</code></td>
<td><code>.html</code></td>
<td>Handlebars</td>
</tr>
<tr>
<td>JSON</td>
<td><code>.json</code> or <code>.html.json</code></td>
<td><code>.html</code></td>
<td>Supports rendering a JSON document through a template to produce HTML</td>
</tr>
<tr>
<td>Liquid</td>
<td><code>.liquid</code> or <code>.html.liquid</code></td>
<td><code>.html</code></td>
<td>LiquidJS</td>
</tr>
<tr>
<td>Nunjucks</td>
<td><code>.njk</code> or <code>.html.njk</code></td>
<td><code>.html</code></td>
<td>Nunjucks</td>
</tr>
</tbody>
</table>
<p>In documents directories, files with these extensions are processed by the named rendering engine, then placed in the same VPath (with the new extension) in the HTML output directory.</p>
<p>In partials or layouts directories, files have either extension, and are used while rendering files in the documents directories.  These files are not copied to the HTML output directory.</p>
<p>In assets directories, files are simply copied to the HTML output directory.</p>
</section>
<section>
<h1>Page layouts</h1>
<p>Layout templates are responsible for establishing the entire page structure.</p>
<p>The HTML resulting from rendering the Markdown or AsciiDoc is available to the layout template as a variable named <em>content</em>.</p>
<p>Consider the default layout template, <code>default.njk</code>:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 1. The default page layout template</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge,chrome=1&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>/&gt;</span>

{% import &quot;ak_core_macros.njk&quot; as ak_core with context %}
{% import &quot;ak_base_macros.njk&quot; as ak_base with context %}

<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>{{ title }}<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
{{ ak_core.stylesheets() }}
{{ ak_core.headerJavaScript() }}
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container-fluid&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;main&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- include our document&apos;s content --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">article</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-md-9&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{{ title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      {{ content }}
  <span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
{{ ak_core.footerJavaScript() }}
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
</div>
</div>
<p>This template is derived from ones used for regular websites.  It is in Nunjucks format.</p>
<p>It imports Nunjucks macros from the AkashaCMS <em>built-in</em> and <em>base</em> plugins.  For example, the AkashaCMS configuration includes a list of stylesheet and JavaScript files.  The macros shown here format those lists into appropriate <code>&lt;link&gt;</code> and <code>&lt;script&gt;</code> tags.</p>
<p>Bootstrap classes are used to aid page layout, but can be used for other purposes.  For example, the <code>default.njk</code> layout template just above was wrapped in a Bootstrap Card component.</p>
<p>As said earlier, the content from the previous rendering stage is available as the variable <em>content</em>. The page title is also available as a variable named <code>title</code>.</p>
<section>
<h2>Partial templates</h2>
<p>Partials are typically a small template meant to help format commonly used HTML structures.</p>
<p>For example, each document might have a metadata field (we&apos;ll discuss this later) named <code>publicationDate</code> which you might want to present somewhere.  In the AkashaCMS Base plugin, the partial <code>ak_publdate.html.njk</code> is available for this purpose (in NJK format):</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 2. Displaying a publication date</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html">{% if publicationDate %}
    Date: {{ publicationDate | escape }}
{% endif %}
</code></pre>
</div>
</div>
<p>This can be invoked by the custom tag</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 3. Using the <code>&lt;partial&gt;</code> tag</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">partial</span> <span class="hljs-attr">file-name</span>=<span class="hljs-string">&quot;ak_publdate.html.njk&quot;</span> <span class="hljs-attr">data-publication-date</span>=<span class="hljs-string">&quot;Date String&quot;</span>/&gt;</span>
</code></pre>
</div>
</div>
<p>There are other methods such as the <code>&lt;publication-date&gt;</code> tag, or the <code>akpublicationdate</code> extension installed in Nunjucks, both of which invoke this same partial template.</p>
</section>
</section>
<section>
<h1>Document format, and document metadata</h1>
<p>We&apos;ve already discussed three items that are contained in document metadata.</p>
<p>Like many systems, the document format supports YAML frontmatter which turns into the document metadata.</p>
<p>It looks roughly like this:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 4. YAML Frontmatter</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">title:</span> <span class="hljs-string">Gettysburg</span> <span class="hljs-string">Address</span>
<span class="hljs-attr">layout:</span> <span class="hljs-string">page.html.ejs</span>
<span class="hljs-attr">publicationDate:</span> <span class="hljs-string">January</span> <span class="hljs-number">7</span><span class="hljs-string">,</span> <span class="hljs-number">2025</span>
<span class="hljs-attr">otherTag:</span> <span class="hljs-string">otherValue</span>
<span class="hljs-attr">tag42:</span> <span class="hljs-string">&quot;The Meaning of Life&quot;</span>
<span class="hljs-meta">---</span>
<span class="hljs-string">This</span> <span class="hljs-string">is</span> <span class="hljs-string">the</span> <span class="hljs-string">content</span> <span class="hljs-string">area.</span>
</code></pre>
</div>
</div>
<p>The area reading <em>this is the content area</em> is the content body for the document.  The part between the lines of three dashes (<code>---</code>) is the frontmatter, and must be in YAML format.</p>
<p>When a document is read, it is first parsed into <em>body</em> (or sometimes <em>docContent</em>) and <em>metadata</em> (or sometimes <em>docMetadata</em>).</p>
<p>The metadata object is available, as discussed earlier, to templates as &quot;<em>variables</em>&quot;.  The NJK template snippet, <code>{{ publicationDate | escape }}</code>, means to access the metadata variable <code>publicationDate</code> and then apply the <code>escape</code> filter.</p>
<section>
<h2>Default metadata values in PDF Document Maker</h2>
<p>As a convenience, PDF Document Maker supports command-line options for two metadata values:</p>
<ul>
<li><code>--title</code> supplies the value for <code>title</code>, and overrides any existing value</li>
<li><code>--layout</code> supplies the value for <code>layout</code>, and overrides any existing value</li>
<li><code>--publication-date</code> supplies the value for <code>publicationDate</code>, and overrides any existing value</li>
</ul>
</section>
<section>
<h2>The meaning for certain metadata values</h2>
<p>Generally the content metadata is simply data with no other defined purpose.  It is up to the templates used for processing your documents define the purpose of each metadata value.</p>
<p>Some fields do have defined purposes:</p>
<ul>
<li><code>title</code> serves as the page title, and might be used in the <code>&lt;title&gt;</code> tag as well as in a prominent <code>&lt;h1&gt;</code> tag at the top of the page.</li>
<li><code>layout</code> names the layout template to use with this document.</li>
<li><code>publicationDate</code> is a date string (it will be parsed by the Date class) on which the document was <em>published</em>.</li>
</ul>
</section>
</section>
<section>
<h1>CSS styles for print</h1>
<p>Most of us use CSS for theming web pages shown in a web browser.  We&apos;ll create a CSS stylesheet, include it in our web page, and not at all care about the <code>@media</code> tag in CSS.</p>
<p>Using <code>@media</code> we can target some of our CSS declarations for <code>screen</code> display:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 5. CSS for display devices</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-css"><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">900px</span>) {
    <span class="hljs-comment">/* ... */</span>
}
</code></pre>
</div>
</div>
<p>This targets regular display screens at least 900px wide.</p>
<p>We might not be aware of the need for specific CSS rules to handle printing.  Printed output has different requirements than screen display.  To produce a good quality PDF/print document we must take this into account.  Doing so starts with this:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 6. CSS for print devices</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-css"><span class="hljs-keyword">@media</span> print {
    <span class="hljs-comment">/* All your print styles go here */</span>
}
</code></pre>
</div>
</div>
<p>What you do is up to you.</p>
<p>To specify stylesheets:</p>
<ul>
<li><code>--style &lt;cssFile...&gt;</code> - File names of CSS style sheets</li>
<li><code>--lesscss &lt;lesscssFile...&gt;</code> - File names of LESS files to render to CSS</li>
</ul>
<p>The <code>--style</code> parameter is used for regular CSS files.  These can be stored either in an <code>asset</code> directory or a <code>document</code> directory.  When the document is rendered, the CSS files will be copied unmodified into the HTML output directory.</p>
<p>The <code>--lesscss</code> parameter is used for LESS files, which is a format for improved CSS syntax.  These files must be stored in a <code>document</code> directory, have an extension of either <code>.less</code> or <code>.css.less</code>, and are rendered from LESS the format to CSS.</p>
<p>In each case the parameter can be repeated multiple times to handle multiple files.  The pathname must be a complete VPath with a leading slash.</p>
<p>Using the <code>--style</code> or <code>--lesscss</code> parameter causes a <code>&lt;link&gt;</code> tag to be generated in the <code>&lt;head&gt;</code> section of the document.</p>
<p>Here are links to articles that are useful for understanding CSS for printing:</p>
<ul>
<li><a href="https://www.sitepoint.com/css-printer-friendly-pages/"><code>https://www.sitepoint.com/css-printer-friendly-pages/</code></a></li>
<li><a href="https://didoesdigital.com/blog/print-styles/"><code>https://didoesdigital.com/blog/print-styles/</code></a></li>
<li><a href="https://www.makeuseof.com/format-web-page-for-printer/"><code>https://www.makeuseof.com/format-web-page-for-printer/</code></a></li>
<li><a href="https://www.smashingmagazine.com/2015/01/designing-for-print-with-css/"><code>https://www.smashingmagazine.com/2015/01/designing-for-print-with-css/</code></a></li>
</ul>
<p>Support for <a href="https://printedcss.com/"><code>https://printedcss.com/</code></a> is bundled in PDF Document Maker.  It is automatically included in the stylesheet declarations.</p>
<p>If you prefer to disable this, use the <code>--no-printcss</code> option.</p>
<p>Some other frameworks for CSS for printing:</p>
<ul>
<li><a href="https://github.com/BafS/Gutenberg"><code>https://github.com/BafS/Gutenberg</code></a></li>
<li><a href="https://github.com/vladocar/Hartija---CSS-Print-Framework?tab=readme-ov-file"><code>https://github.com/vladocar/Hartija---CSS-Print-Framework?tab=readme-ov-file</code></a></li>
<li><a href="https://github.com/cognitom/paper-css"><code>https://github.com/cognitom/paper-css</code></a></li>
<li><a href="https://www.getpapercss.com/"><code>https://www.getpapercss.com/</code></a></li>
</ul>
<p>For example to use Gutenberg, start by adding it to your project dependencies:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 7. Install Gutenberg CSS</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npm install gutenberg-css --save</span>
</code></pre>
</div>
</div>
<p>Then create an asset directory:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 8. Create assets directory to hold files</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash"><span class="hljs-built_in">mkdir</span> -p assets/vendor/gutenberg</span>
</code></pre>
</div>
</div>
<p>It is good practice to use a directory path <code>/vendor/VENDOR-NAME</code> to store files sourced from a particular project.</p>
<p>Then copy the Gutenberg CSS into that directory:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 9. Copy files into the directory</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash"><span class="hljs-built_in">cp</span> -r node_modules/gutenberg-css/dist/ assets/vendor/gutenberg/</span>
</code></pre>
</div>
</div>
<p>And finally, when running PDF Document Maker we add <code>--style vendor/gutenberg/dist/gutenberg.css</code></p>
<div class="card">
<div class="card-title">
<p><strong>Figure 10. Add this directory and stylesheet to config</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npx pdf-document-maker  \
        --document-dir documents \
        --pdf-output PDF \
        --html-output out \
        --title <span class="hljs-string">&apos;Markdown test document&apos;</span> \
        --asset-dir assets \
        --style vendor/gutenberg/dist/gutenberg.css \
        --format A4 \
        TEST.md</span>
</code></pre>
</div>
</div>
</section>
<section>
<h1>Project configuration with the PDF Document Maker CLI</h1>
<p>We discussed earlier that a PDF Document Maker project directory contains the Node.js <code>package.json</code> file where one dependency is <code>@akashacms/pdf-document-maker</code>.  The directory must also contain the sort of files mentioned earlier.</p>
<p>Most of the project configuration is handled with command-line options.  The <code>--help</code> option will show you the full list of options.</p>
<p>The configuration options cover two broad areas:</p>
<ul>
<li>Generating HTML from the input files - These options control generation of the AkashaCMS configuration object</li>
<li>Generating PDF from the HTML - These options control the Puppeteer configuration</li>
</ul>
<section>
<h2>Output directories</h2>
<p>Two output directories are created:</p>
<table class="table">
<caption>Table 3. Output directories</caption>
<thead>
<tr>
<th>Output</th>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTML Output</td>
<td><code>--html-output</code></td>
<td>This directory contains the directory structure of HTML, CSS, JavaScript, and images, which will be rendered into the PDF.  The structure is precisely the same as a static website, meaning the files are placed in a directory structure that can be deployed to a regular website.</td>
</tr>
<tr>
<td>PDF Output</td>
<td><code>--pdf-output</code></td>
<td>This directory contains the PDF file which is generated.</td>
</tr>
</tbody>
</table>
</section>
<section>
<h2>Header and Footer text in the PDF</h2>
<p>A key feature offered by word processing systems like Libre Office is placing text in the margin at the top and bottom of the page.  This header and footer text usually carries a date, page number, copyright statement, and document title.</p>
<p>PDF Document Maker supports four options to control headers and footers:</p>
<ul>
<li><code>--template-header</code> - A file name for a file containing an HTML snippet describing the text to use in the header</li>
<li><code>--height-header</code> - The height of the header area</li>
<li><code>--template-footer</code> - A file name for a file containing an HTML snippet describing the test to use in the footer</li>
<li><code>--height-footer</code> - The height of the footer area</li>
</ul>
<p>The template files are HTML snippets where values are injected into HTML elements with specific class names.  The class names are <a href="https://pptr.dev/api/puppeteer.pdfoptions#headertemplate">from the Puppeteer documentation</a>:</p>
<ul>
<li><code>date</code> formatted print date</li>
<li><code>title</code> document title</li>
<li><code>url</code> document location</li>
<li><code>pageNumber</code> current page number</li>
<li><code>totalPages</code> total pages in the document</li>
</ul>
<p>For example, to output the text <em>Page 2 of 42</em>, use this template:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 11. Page footer template</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html">Page <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pageNumber&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span> of <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;totalPages&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
</code></pre>
</div>
</div>
<p>For the <code>&lt;span&gt;</code> with <code>class=&quot;pageNumber&quot;</code>, the current page number is injected into the content of that HTML element.</p>
<p>An additional thing to know is that the context where the header and footer is rendered has zero CSS settings.  It does not inherit the CSS of the main part of the page, and you must initialize any CSS settings required to ensure your header and footer shows up.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 12. Complete page footer template</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;text-left&quot;</span>
  <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin: 0 auto 0 20mm; text-align: left; font-size: 12px;&quot;</span>&gt;</span>
    PDF Document Maker Organization
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;text-right&quot;</span>
  <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin: 0 20mm 0 auto; text-align: right; font-size: 12px;&quot;</span>&gt;</span>
    Page <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pageNumber&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      of <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;totalPages&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
</div>
</div>
<p>The <code>text-left</code> span has style which glues it to the left hand side of the row, sets the row to 20mm high, and sets the font-size to 12px.  The <code>text-right</code> span is the same, but glues itself to the right-hand side of the row.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 13. Command-line parameters for header/footer templates</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs">--<span class="hljs-keyword">template</span>-header header-<span class="hljs-keyword">template</span>.html \
--height-header <span class="hljs-number">20</span>mm \
--<span class="hljs-keyword">template</span>-footer footer-<span class="hljs-keyword">template</span>.html \
--height-footer <span class="hljs-number">20</span>mm 
</code></pre>
</div>
</div>
</section>
<section>
<h2>Controlling page layout</h2>
<p>As we discussed earlier, the <code>--layout</code> option lets us specify a page layout template.</p>
<p>Layout templates are stored in the <em>Layouts Dirs</em>, which we specify using the <code>--layout-dir</code> option.</p>
</section>
<section>
<h2>Page styling using CSS stylesheets</h2>
<p>We can further customize the document presentation using CSS stylesheets.  The design allows us to use any number of stylesheets, and to use the LESS format for creating stylesheets.</p>
<p>For each kind of stylesheet we can repeat the option more than once:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 14. Example stylesheet parameters</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npx pdf-document-maker ... \
    --style assets/style1.css --style assets/style2.css \
    --lesscss assets/style3.less --lesscss assets/style4.less</span>
    ...
</code></pre>
</div>
</div>
<p>The filenames are VPaths.  In this example, each of the CSS files are located in the <code>assets</code> virtual directory.</p>
<p>For <code>--style</code> parameters, the file is expected to be in CSS format, and is simply copied into the HTML output directory.  These files can be either in an <em>assets</em> directory, or <em>documents</em> directory.</p>
<p>For <code>--lesscss</code> parameters, the file will be rendered using the LESS processor.  This means the files must have an extension of <code>.css.less</code> or <code>.less</code>, and be in a <em>documents</em> directory.</p>
<p>Additionally, by default the <em>PrintCSS</em> stylesheet will be used.  This is from an open source project, and is CSS for produces good looking print documents.  This style-sheet can be disabled using the <code>--no-printcss</code> option.</p>
<p>Additionally, by default the Bootstrap v4 framework is used.  For the PDF documents most of Bootstrap is not useful.  It has powerful page layout capabilities, and certain components may be useful for creating visual effects.  This framework may be disabled with the <code>--no-bootstrap</code> option.</p>
<p>All style-sheets, whether the default <code>print.css</code> file or those specified on the command line, are added to a list.  The page layout template is expected to use either of these methods:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 15. Generating stylesheet tags in page layout template</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- NJK macro for generating link tags to CSS files --&gt;</span>
{{ ak_core.stylesheets() }}
<span class="hljs-comment">&lt;!-- a custom HTML tag for the same purpose --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ak-stylesheets</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ak-stylesheets</span>&gt;</span>
</code></pre>
</div>
</div>
<p>Both of these convert the list of style-sheet references into <code>&lt;link&gt;</code> tags referencing the style-sheets.</p>
</section>
<section>
<h2>Markdown extensions supported by PDF Document Maker</h2>
<p>The Markdown ecosystem includes a wide variety of extensions, adding additional features to the language.  PDF Document Maker uses the Node.js Markdown IT engine, and can in theory use any of the available plugins.  Several are already bundled into the application, with these effects.</p>
<section>
<h4>Auto-generating &quot;anchor&quot; text for header tags</h4>
<p>This extension causes an <code>id=&quot;anchor&quot;</code> attribute to be added to the HTML header tag like so:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 16. Example anchor tag generation</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html">## A Markdown H2 tag
<span class="hljs-comment">&lt;!-- becomes --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;generated anchor&quot;</span>&gt;</span>A Markdown H2 tag<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
</code></pre>
</div>
</div>
<p>This allows an <code>&lt;a href=&quot;#anchor&quot;&gt;Link text&lt;/a&gt;</code> tag to link directly to the header tag.  This would be useful in Tables of Content, where the links would go directly to the section.</p>
<p>This feature can be disabled with <code>--no-md-anchor</code></p>
</section>
<section>
<h4>Generating footnote blocks</h4>
<p>Allows authors to write footnotes.<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>  A footnote is referenced with a marker, such as <code>[^1]</code>.  The footnote is defined by writing a paragraph like this:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 17. Example footnote</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs">[<span class="hljs-symbol">^1</span>]: <span class="hljs-link">This is the body of the footnote.</span>
</code></pre>
</div>
</div>
<p>The extension sets up internal links between the two points.</p>
<p>This feature can be disabled with <code>--no-md-footnote</code></p>
</section>
<section>
<h4>Adding either id= or class= attributes to HTML</h4>
<p>To implement styling using CSS requires the ability to set ID or Class values.  Example:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 18. Adding attributes to HTML in Markdown</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs"><span class="hljs-meta"># header {.style-me}</span>
<span class="hljs-title">paragraph</span> {<span class="hljs-class"><span class="hljs-keyword">data</span>-toggle=modal}</span>
</code></pre>
</div>
</div>
<p>The stuff between <code>{</code> and <code>}</code> are where we list the attributes to add to the rendered HTML tags after.  The above will be converted to:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 19. Generated HTML with new attributes</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;style-me&quot;</span>&gt;</span>header<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-toggle</span>=<span class="hljs-string">&quot;modal&quot;</span>&gt;</span>paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
</code></pre>
</div>
</div>
<p>For example, Bootstrap has some text colors available as classes such as <code>.text-primary</code>.  One can insert <em class="text-primary">primary</em> text inline in a paragraph using <code>{.text-primary}</code>.  It appears there is a bug in that for the attribute to take effect it must be associated with text that has a tag, such as <em class="text-primary">primary</em>, rather than simple text like primary{.text-primary}, which does not have a tag.</p>
<p class="text-success">Likewise, an entire paragraph can be in the <code>text-success</code> color using a suitable marker. </p>
<p>To fix the bug just described <span class="text-primary">surround some text in brackets</span> which causes the bracketed-spans plugin to add a <code>&lt;span&gt;</code> tag around the bracketed text.</p>
<p>To set <code>class=</code> or <code>id=</code> attributes on a table, place the marker two newlines after the table, like so:</p>
<pre><code class="hljs">Col <span class="hljs-number">1</span> <span class="hljs-string">| Col 2</span>
<span class="hljs-punctuation">-</span><span class="hljs-punctuation">-</span><span class="hljs-punctuation">-</span><span class="hljs-punctuation">-</span><span class="hljs-punctuation">-</span><span class="hljs-punctuation">-</span><span class="hljs-string">|------</span>
Val <span class="hljs-number">1</span> <span class="hljs-string">| Val 2</span>
Val <span class="hljs-number">1</span> <span class="hljs-string">| Val 2</span>

{<span class="hljs-meta">#id-table-one .example-table-class}</span>
</code></pre>
<p>Which renders as so:</p>
<table id="id-table-one" class="example-table-class">
<thead>
<tr>
<th>Col 1</th>
<th>Col 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>Val 1</td>
<td>Val 2</td>
</tr>
<tr>
<td>Val 1</td>
<td>Val 2</td>
</tr>
</tbody>
</table>
<p>You must inspect the page source to see the class and ID values.</p>
<p>Special treatment is also required for lists.</p>
<pre><code class="hljs">* This <span class="hljs-built_in">item</span> has <span class="hljs-keyword">the</span> <span class="hljs-keyword">last</span> <span class="hljs-built_in">word</span> <span class="hljs-keyword">in</span> **primary**{.<span class="hljs-built_in">text</span>-primary}
* If <span class="hljs-keyword">the</span> final <span class="hljs-built_in">word</span> <span class="hljs-keyword">is</span> non-bold <span class="hljs-keyword">then</span> this applies <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> whole <span class="hljs-built_in">list</span> <span class="hljs-built_in">item</span>{.<span class="hljs-built_in">text</span>-primary}
* This <span class="hljs-built_in">item</span> <span class="hljs-keyword">is</span> completely <span class="hljs-keyword">in</span> secondary {.<span class="hljs-built_in">text</span>-secondary}
</code></pre>
<p>Which renders as</p>
<ul>
<li>This item has the last word in <strong class="text-primary">primary</strong></li>
<li class="text-primary">If the final word is non-bold then this applies to the whole list item</li>
<li class="text-secondary">This item is completely in secondary</li>
</ul>
<p>Then, to apply a class to an entire list</p>
<pre><code class="hljs"><span class="hljs-comment">* Every item in</span>
<span class="hljs-comment">* this list is in</span>
<span class="hljs-comment">* the danger color</span>
{.text-danger}
</code></pre>
<p>Which renders as so:</p>
<ul class="text-danger">
<li>Every item in</li>
<li>this list is in</li>
<li>the danger color</li>
</ul>
<p>A nested list has special treatment:</p>
<pre><code class="hljs">* Non-indented <span class="hljs-built_in">list</span> <span class="hljs-built_in">item</span>
* Non-indented <span class="hljs-built_in">list</span> <span class="hljs-built_in">item</span> <span class="hljs-number">2</span>
* Non-indented <span class="hljs-built_in">list</span> items are <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;text-success&quot;</span> color
    * Indented <span class="hljs-built_in">list</span> <span class="hljs-built_in">item</span>
    * Indented <span class="hljs-built_in">list</span> <span class="hljs-built_in">item</span> <span class="hljs-number">2</span>
    * These items are <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;text-info&quot;</span> color
{.<span class="hljs-built_in">text</span>-info}

{.<span class="hljs-built_in">text</span>-success}
</code></pre>
<p>Which renders as so:</p>
<ul class="text-success">
<li>Non-indented list item</li>
<li>Non-indented list item 2</li>
<li>Non-indented list items are in &quot;text-success&quot; color
<ul class="text-info">
<li>Indented list item</li>
<li>Indented list item 2</li>
<li>These items are in &quot;text-info&quot; color</li>
</ul>
</li>
</ul>
<p>As with tables, the marker which applies to the entire list follows the list by two lines, whereas the marker for an indented sub-list immediately follows the list.</p>
<p>The extension allows setting other attributes beyond ID and Class.  But, most other attributes are potential security vulnerabilities.  The extension has been configured to only allow <code>id=</code> and <code>class=</code> attributes.</p>
<p>Use of these attributes should then correspond to entries in CSS stylesheets.</p>
<p>Be aware that the <code>-anchors</code> extension and <code>-attrs</code> extension both deal with the <code>id=</code> value on headers.  With <code>-anchors</code> the author is not in control of the choice for the <code>id=</code> value, whereas with the <code>-attrs</code> extension the author chooses the <code>id=</code> value.</p>
<p>This feature can be disabled with <code>--no-md-attrs</code></p>
</section>
<section>
<h4>Adding a <code>&lt;span&gt;</code> tag around some text</h4>
<p>It is sometimes useful to add a <code>&lt;span&gt;</code> tag around some text.  Your document may need this to add an <code>id=</code> or <code>class=</code> to a section of text using the attributes marker shown in the previous section.</p>
<p>As discussed in that section, this example does not attach the desired class attribute:</p>
<pre><code class="hljs"><span class="hljs-type">Text</span> <span class="hljs-keyword">with</span> desired <span class="hljs-keyword">primary</span>{.text-<span class="hljs-keyword">primary</span>} <span class="hljs-keyword">attribute</span>.

Other <span class="hljs-type">text</span> <span class="hljs-keyword">using</span> [bracketed span <span class="hljs-keyword">to</span> utilize the <span class="hljs-keyword">primary</span>]{.text-<span class="hljs-keyword">primary</span>} <span class="hljs-keyword">attribute</span>.
</code></pre>
<p>As noted in the previous section, the attribute does not get attached to text that does not have a tag, as demonstrated by the first line of text.  The brackets (<code>[</code> and <code>]</code>) around text in the second line causes the bracketed-span extension to add a <code>&lt;span&gt;</code> tag, allowing the attribute to be applied.</p>
<p>The above example renders as so:</p>
<p>Text with desired primary{.text-primary} attribute.</p>
<p>Other text using <span class="text-primary">bracketed span to utilize the primary</span> attribute.</p>
<p>This feature can be disabled with <code>--no-md-bracketed-span</code>.</p>
</section>
<section>
<h4>Simplify adding a <code>&lt;div&gt;</code> block</h4>
<p>Another way to customize the resulting HTML is to add <code>&lt;div&gt;</code> tags with certain attributes.  For example a box with a yellow background and solid brown border could serve to draw attention to some content.  The color effects are easy to define in CSS, and the ability to add a <code>&lt;div&gt;</code> gives the opportunity to wrap a contain some content within a box.</p>
<p>Example:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 20. Adding a <code>&lt;div&gt;</code> to some content</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs"><span class="hljs-meta">:::</span> #warning
<span class="hljs-strong">*here be dragons*</span>
<span class="hljs-meta">:::</span>
</code></pre>
</div>
</div>
<div class="card">
<div class="card-title">
<p><strong>Figure 21. That generates the following:</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;warning&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>here be dragons<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
</div>
</div>
<p>While this is easy to use, one has to consider that Markdown engines like Markdown-IT allow the author to use HTML tags.  It&apos;s therefore easy to add <code>&lt;div&gt;</code> tags without requiring a Markdown extension.</p>
<p>This feature can be disabled with <code>--no-md-div</code></p>
</section>
<section>
<h4>Adding <code>&lt;section&gt;</code> tags corresponding to header tags</h4>
<p>One may think of a Header tag followed by some content as a &quot;section&quot; of a document.  This extension implements that idea with HTML tags.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 22. Implicit sections in Markdown</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs"># Header <span class="hljs-number">1</span>
Text.
### Header <span class="hljs-number">2</span>
Lorem?
## Header <span class="hljs-number">3</span>
Ipsum.
# Last header
Markdown rules!
</code></pre>
</div>
</div>
<p>That&apos;s four sections, some of which should be nested within outer sections.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 23. The extension generates explicit <code>&lt;section&gt;</code> tags</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Text.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Header 2<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Lorem?<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Header 3<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Ipsum.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Last header<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Markdown rules!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
</code></pre>
</div>
</div>
<p>If the <code>-attrs</code> extension is enabled, we might have added <code>id=</code> or <code>class=</code> attributes to our headers.  If so, these attributes are moved to the <code>&lt;section&gt;</code> surrounding the header.</p>
<p>This feature can be disabled with <code>--no-md-header-section</code></p>
</section>
<section>
<h4>Adding syntax highlighting to code sections</h4>
<p>The HighlightJS package handles syntax coloring for content within code blocks.  There are many examples of this all through this document.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 24. At the HTML level the HighlightJS package looks for this:</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;html&quot;</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
</code></pre>
</div>
</div>
<p>The class name is a language code.  The supported languages are listed in their GitHub repository: <a href="https://github.com/highlightjs/highlight.js/blob/main/SUPPORTED_LANGUAGES.md"><code>https://github.com/highlightjs/highlight.js/blob/main/SUPPORTED_LANGUAGES.md</code></a></p>
<p>In Markdown a code block is text within two lines of three backticks.  The language code is placed immediately after the opening backticks.</p>
<p>This feature can be disabled with <code>--no-md-highlightjs</code></p>
</section>
<section>
<h4>Convert image references into <code>&lt;figure&gt;</code> tags</h4>
<p>This allows rendering an image reference in Markdown as a <code>&lt;figure&gt;</code> tag containing an <code>&lt;img&gt;</code> tag and optionally a <code>&lt;figcaption&gt;</code> tag.  This construct is important in modern HTML.</p>
<p>The <code>&lt;figure&gt;</code> element represents self-contained content.  The figure, its caption, and its contents are treated by web browsers as a single unit.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 25. Example Markdown image tag</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs">!<span class="hljs-selector-attr">[This is an alt]</span>(fig<span class="hljs-selector-class">.png</span> <span class="hljs-string">&quot;This is a title&quot;</span>)
</code></pre>
</div>
</div>
<div class="card">
<div class="card-title">
<p><strong>Figure 26. The extension generates this HTML</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">figure</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;fig.png&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;This is an alt&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">figcaption</span>&gt;</span>This is a title<span class="hljs-tag">&lt;/<span class="hljs-name">figcaption</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">figure</span>&gt;</span>
</code></pre>
</div>
</div>
<div class="card">
<div class="card-title">
<p><strong>Figure 27. A Markdown link can be placed around an image tag</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs">[<span class="hljs-name">!</span>[<span class="hljs-name">This</span> is an alt](<span class="hljs-name">fig.png</span> <span class="hljs-string">&quot;This is a title&quot;</span>)](<span class="hljs-name">http://some.where</span>)
</code></pre>
</div>
</div>
<p>Notice that this is structured as so: <code>[...image tag..](URL)</code></p>
<div class="card">
<div class="card-title">
<p><strong>Figure 28. The <code>&lt;a&gt;</code> link is applied to the <code>&lt;img&gt;</code> tag</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">figure</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;http://some.where&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;fig.png&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;This is an alt&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">figcaption</span>&gt;</span>This is a title<span class="hljs-tag">&lt;/<span class="hljs-name">figcaption</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">figure</span>&gt;</span>
</code></pre>
</div>
</div>
<p>This feature can be disabled with <code>--no-md-image-figure</code></p>
</section>
<section>
<h4>Special image processing</h4>
<p>More advanced image processing is available in the extended <code>&lt;img&gt;</code> tag implemented by AkashaCMS components.  This is the normal <code>&lt;img&gt;</code> tag with a few extra attributes and properties.  These allow us to specify a <code>&lt;figure&gt;/&lt;figcaption&gt;</code> structure or to resize images.</p>
<p>Adding the <code>figure</code> property triggers a rewrite of the following</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 29. We can add a <code>figure</code> property to trigger special processing</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;..ID&quot;</span> <span class="hljs-attr">figure</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;..HREF&quot;</span> <span class="hljs-attr">caption</span>=<span class="hljs-string">&quot;..CAPTION&quot;</span>/&gt;</span>
</code></pre>
</div>
</div>
<div class="card">
<div class="card-title">
<p><strong>Figure 30. It rewrites the <code>&lt;img&gt;</code> into the <code>&lt;figure&gt;/&lt;img&gt;</code> structure</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">figure</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;..ID&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;..HREF&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">figcaption</span>&gt;</span>..CAPTION<span class="hljs-tag">&lt;/<span class="hljs-name">figcaption</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">figure</span>&gt;</span>
</code></pre>
</div>
</div>
<p>The recognized attributes are:</p>
<ul>
<li><code>id</code> becomes the <code>id</code> of the <code>&lt;figure&gt;</code></li>
<li><code>class</code> becomes the <code>class</code> of the <code>&lt;figure&gt;</code></li>
<li><code>width</code> becomes the <code>width</code> of the <code>&lt;figure&gt;</code></li>
<li><code>style</code> becomes the <code>style</code> of the <code>&lt;figure&gt;</code></li>
<li><code>dest</code> becomes an <code>&lt;a&gt;</code> tag surrounding the <code>&lt;img&gt;</code> within the <code>&lt;figure&gt;</code></li>
<li><code>caption</code> becomes a <code>&lt;figcaption&gt;</code> tag within the <code>&lt;figure&gt;</code></li>
</ul>
<div class="card">
<div class="card-title">
<p><strong>Figure 31. Larger <code>&lt;img figure&gt;</code> example</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">figure</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;fig1&quot;</span> <span class="hljs-attr">caption</span>=<span class="hljs-string">&quot;Figure 1.&quot;</span>
   <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;some-class&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;400&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;CSS declarations&quot;</span>
   <span class="hljs-attr">dest</span>=<span class="hljs-string">&quot;http://example.com&quot;</span>
   <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./img/fig1.png&quot;</span>/&gt;</span>
</code></pre>
</div>
</div>
<div class="card">
<div class="card-title">
<p><strong>Figure 32. Is rendered to</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">figure</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;fig1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;some-class&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;CSS&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;http://example.org&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./img/fig1.png&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">figure</span>&gt;</span>
</code></pre>
</div>
</div>
<p>This extended <code>&lt;img&gt;</code> tag does more than the <code>-image-figures</code> extension from the previous section.</p>
<p>An image can also be resized when copied to the HTML directory.  It allows you to store a full-size image in the documents directory, but use a smaller image when deploying to a website, or in a PDF.</p>
<p>The recognized attributes are:</p>
<ul>
<li><code>src</code> The file within the documents or assets directories that is copied into the render output</li>
<li><code>resize-to</code> The file name used within the render output directory</li>
<li><code>resize-width</code> The resulting image width as discussed above.</li>
</ul>
<p>This tag</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 33. Image resizing</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;resizeto150&quot;</span> 
        <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;img/Human-Skeleton.jpg&quot;</span>
        <span class="hljs-attr">resize-width</span>=<span class="hljs-string">&quot;150&quot;</span>
        <span class="hljs-attr">resize-to</span>=<span class="hljs-string">&quot;img/Human-Skeleton-150.jpg&quot;</span>&gt;</span>
</code></pre>
</div>
</div>
<p>Becomes the following:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 34. Resized image</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;resizeto150&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;img/Human-Skeleton-150.jpg&quot;</span>&gt;</span>
</code></pre>
</div>
</div>
<p>Additionally, the source file <code>img/Human-Skeleton.jpg</code> is copied to the HTML directory as the destination file <code>img/Human-Skeleton-150.jpg</code>, and is resized to 150 pixels in width.</p>
</section>
<section>
<h4>Multimarkdown table format</h4>
<p>Multimarkdown is one of the extended Markdown specifications.  This extension supports its table format.</p>
<p>This feature can be disabled with <code>--no-md-multimd-table</code></p>
</section>
<section>
<h4>Add <code>&lt;caption&gt;</code> tag to a table</h4>
<p>We might want to place &quot;<em>Table 1. Global Policy Challenges</em>&quot; either before or after a table, and have it treated as being associated with the table.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 35. Table with caption</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs">Table: A Caption

|<span class="hljs-string"> A </span>|<span class="hljs-string"> B </span>|
|<span class="hljs-string">---</span>|<span class="hljs-string">---</span>|
|<span class="hljs-string"> 1 </span>|<span class="hljs-string"> 2 </span>|
|<span class="hljs-string"> 3 </span>|<span class="hljs-string"> 4 </span>|
|<span class="hljs-string"> 5 </span>|<span class="hljs-string"> 6 </span>|
</code></pre>
</div>
</div>
<p>Renders as:</p>
<table>
<caption>A Caption</caption>
<thead>
<tr>
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>The effect is to add a <code>&lt;caption&gt;</code> tag within the <code>&lt;table&gt;</code>.</p>
<p>To control the style of the caption, we can add a CSS declaration targeting table captions as so:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 36. CSS to control Table caption styling</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-css"><span class="hljs-selector-tag">table</span> <span class="hljs-selector-tag">caption</span> {
    <span class="hljs-attribute">caption-side</span>: top;
    <span class="hljs-attribute">font-weight</span>: bold;
    <span class="hljs-attribute">font-style</span>: italic;
    <span class="hljs-attribute">font-size</span>: larger;
}
</code></pre>
</div>
</div>
<p>To demonstrate, we&apos;ll create two tables.  The first will have the class <code>.table-caption-above</code>, and the second the class <code>{.table-caption-below}</code>.  The corresponding CSS is:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 37. CSS to control caption positioning</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-css"><span class="hljs-selector-tag">table</span><span class="hljs-selector-class">.table-caption-above</span> <span class="hljs-selector-tag">caption</span> {
    <span class="hljs-attribute">caption-side</span>: top;
}
<span class="hljs-selector-tag">table</span><span class="hljs-selector-class">.table-caption-below</span> <span class="hljs-selector-tag">caption</span> {
    <span class="hljs-attribute">caption-side</span>: bottom;
}
</code></pre>
</div>
</div>
<p>Next, to construct our table while adding a class attribute:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 38. Adding class specifier to control caption positioning</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs">Table: A Caption Above

|<span class="hljs-string"> A </span>|<span class="hljs-string"> B </span>|
|<span class="hljs-string">---</span>|<span class="hljs-string">---</span>|
|<span class="hljs-string"> 1 </span>|<span class="hljs-string"> 2 </span>|
|<span class="hljs-string"> 3 </span>|<span class="hljs-string"> 4 </span>|
|<span class="hljs-string"> 5 </span>|<span class="hljs-string"> 6 </span>|

{.table-caption-above}
</code></pre>
</div>
</div>
<p>Adding an attribute, like a class, to a table requires that last line is separated from the bottom of the table by one blank line.</p>
<p>The result looks like this:</p>
<div class="card-group">
<div class="card">
<div class="card-body">
<table class="table-caption-above">
<caption>Caption Above</caption>
<thead>
<tr>
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="card">
<div class="card-body">
<table class="table-caption-below">
<caption>Caption Below</caption>
<thead>
<tr>
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The important CSS attribute is <code>caption-side</code>, because it control where the caption is shown.</p>
<p>This feature can be disabled with <code>--no-md-table-captions</code></p>
</section>
<section>
<h4>Bootstrap card groups in Markdown</h4>
<p>How did we get those two tables to appear side-by-side?</p>
<p>This page includes the Bootstrap framework.  What we did was to create a Card Group containing two Cards.</p>
<p>To generate the required <code>&lt;div&gt;</code> we used the <code>::: .div-class</code> syntax described earlier.  To implement the card group required:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 39. Demonstrating Bootstrap card groups</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs"><span class="hljs-meta">:::</span> .card-group

<span class="hljs-meta">:::</span> .card
<span class="hljs-meta">:::</span> .card-body

CONTENT FOR FIRST CARD GROUP

<span class="hljs-meta">:::</span>
<span class="hljs-meta">:::</span>

<span class="hljs-meta">:::</span> .card
<span class="hljs-meta">:::</span> .card-body

CONTENT FOR SECOND CARD GROUP

<span class="hljs-meta">:::</span>
<span class="hljs-meta">:::</span>

<span class="hljs-meta">:::</span>
</code></pre>
</div>
</div>
<div class="card">
<div class="card-title">
<p><strong>Figure 40. Rendered Bootstrap card groups</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;card-group&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;card&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;card-body&quot;</span>&gt;</span>
      CONTENT FOR FIRST CARD GROUP
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;card&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;card-body&quot;</span>&gt;</span>
      CONTENT FOR SECOND CARD GROUP
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
</div>
</div>
<p>Or, this:</p>
<div class="card-group">
  <div class="card">
    <div class="card-body">
      CONTENT FOR FIRST CARD GROUP
    </div>
  </div>
  <div class="card">
    <div class="card-body">
      CONTENT FOR SECOND CARD GROUP
    </div>
  </div>
</div>
<p>Hence, one browses the Bootstrap documentation, or the documentation for your preferred CSS framework, and look at the HTML+CSS structures are required to achieve the desired effect.  One then uses <code>:::</code> to create the <code>&lt;div&gt;</code> portion, and <code>{#id .class-name}</code> to implement the ID or Class attributes.</p>
</section>
<section>
<h4>Diagrams using PlantUML</h4>
<p>This is a powerful format for drawing diagrams of importance to software engineers, such as UML diagrams.  The feature is discussed later.</p>
<p>This feature can be disabled with <code>--no-md-plantuml</code></p>
</section>
</section>
</section>
<section>
<h1>Automating PDF Document Making using <code>package.json</code></h1>
<p>The <code>package.json</code> file can serve as a way to record our build procedure.  In this file the <code>scripts</code> section stores commands which can be run.  It&apos;s useful to create and test prebaked scripts so you don&apos;t have to remember how to do things.</p>
<p>It will help to first install <code>npm-run-all</code> because it cleans up the scripts section of <code>package.json</code>.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 41. Installing <code>npm-run-all</code></strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npm install npm-run-all --save</span>
</code></pre>
</div>
</div>
<p>Then in <code>package.json</code> add these items to the <code>scripts</code> tag:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 42. Build scripts in <code>package.json</code></strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-json"><span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;build:guide&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;npm-run-all build:render&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;build:render&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;npx pdf-document-maker --partial-dir partials --layout-dir layouts --document-dir documents --lesscss guide/style.css.less --pdf-output PDF --html-output out --title &apos;PDF Document Maker Guide&apos; --format A4 guide/guide.md&quot;</span>
<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
</code></pre>
</div>
</div>
<div class="card">
<div class="card-title">
<p><strong>Figure 43. Running automated build process</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npm run build:guide</span>
</code></pre>
</div>
</div>
</section>
<section>
<h1>Project configuration with AkashaCMS configuration files</h1>
<p>Under the covers, PDF Document Maker creates an AkashaCMS configuration file.  This file instructs AkashaCMS components on where to find input files, and customizations for generating HTML and other files.</p>
<p>One learns about this configuration file at <a href="https://akashacms.com"><code>https://akashacms.com</code></a>  There is an example file in the repository.</p>
<p>For most projects using the command-line to auto-generate a configuration object is sufficient.  But, some projects may want more control than we can expose with command-line options.</p>
<p>Once you have a config file, add <code>--config configFN</code> to the options.</p>
</section>
<section>
<h1>Drawing diagrams with <code>draw.io</code>, PlantUML, Mermaid, or KaTeX</h1>
<p>There are many tools for creating images of all kinds.  Images feed our need to have a visual view counterpoint to the text in our documents.</p>
<p>The first three three tools are useful to typical software engineers since they make it easy to create diagrams we use in software engineering and other technical fields.  While there are many tools of this nature, these three are easy to use, and easy to integrate with PDF Document Maker.</p>
<p>A fourth tool, KaTeX, is useful for mathematicians, chemists, physicists, engineers, and the like, because of its excellent support for rendering high quality equations.</p>
<section>
<h2>Using <code>draw.io</code> diagrams in PDF Document Maker</h2>
<p>The first, <code>draw.io</code>, is a diagramming tool with a built-in clip art library useful for software engineering, hardware deployment, and other technical fields.  It is very easy to use, and with it one can quickly create complex diagrams.</p>
<p>To learn about the application, visit <a href="https://www.drawio.com/"><code>https://www.drawio.com/</code></a></p>
<p>To use it online, visit <a href="https://draw.io"><code>https://draw.io</code></a></p>
<p>There is an open-source desktop application, where the GitHub repository is at: <a href="https://github.com/jgraph/drawio-desktop">https://github.com/jgraph/drawio-desktop</a>  However, on <code>drawio.com</code> there is a download link going back to the GitHub repository.  And, the desktop application may be available via package management systems.  On Linux, it is available via Flathub.</p>
<p>Once you&apos;ve drawn an image, the best way to proceed is to save the drawing as PNG.</p>
<figure data-type="image" tabindex="1"><img src="./img/draw-io-export.png" alt="Exporting an image from "></figure>
<p>On this screen you choose the export options.</p>
<figure data-type="image" tabindex="2"><img src="./img/draw-io-export-png.png" alt="Choosing export options"></figure>
<p>The &quot;<em>include a copy of my diagram</em>&quot; ensures that the PNG can be edited by <code>draw.io</code> in the future.  That is, the resulting PNG has information about the drawing such that <code>draw.io</code> can recreate the editing experience.</p>
<p>The diagram is easy to include in Markdown using the normal image tag.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 44. Image tag for <code>draw.io</code> diagram</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs">!<span class="hljs-selector-attr">[Example diagram]</span>(./<span class="hljs-selector-tag">img</span>/example-drawio-diagram<span class="hljs-selector-class">.png</span>)
</code></pre>
</div>
</div>
<p>Which results in the following:</p>
<figure data-type="image" tabindex="3"><img src="./img/example-drawio-diagram.png" alt="Example diagram"></figure>
<p>If in the future you need to edit the diagram, simply load the PNG file back into <code>draw.io</code>.  When done editing the file make sure to save it using the same procedure.</p>
</section>
<section>
<h2>Using PlantUML diagrams in PDF Document Maker</h2>
<p>PlantUML - <a href="https://plantuml.com/"><code>https://plantuml.com/</code></a> - is a versatile tool for creating a number of diagrams useful in software engineering and related fields.  As the name suggests it focuses mostly on UML diagrams.</p>
<p>With PlantUML you create a textual description of the diagram to create.  The description is placed inline with the Markdown file.  When the document is rendered to HTML, the description is converted to an SVG representation of the description.</p>
<p>The conversion can be disabled by using the <code>--no-md-plantuml</code> option.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 45. Example PlantUML diagram</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs">@startuml

start

<span class="hljs-keyword">if</span> (Graphviz installed?) <span class="hljs-keyword">then</span> (<span class="hljs-literal">yes</span>)
  :process all<span class="hljs-string">\ndiagrams;</span>
<span class="hljs-keyword">else</span> (<span class="hljs-literal">no</span>)
  :process only
  __sequence__ <span class="hljs-keyword">and</span> __activity__ diagrams;
endif

stop

@enduml
</code></pre>
</div>
</div>
<!-- THIS IS THE OLD METHOD

Simply insert that text in the Markdown file.  The default delimiters are `@startuml` and `@enduml`, with everything in-between interpreted as the PlantUML diagram.

@startuml

start

if (Graphviz installed?) then (yes)
  :process all\ndiagrams;
else (no)
  :process only
  __sequence__ and __activity__ diagrams;
endif

stop

@enduml
-->
<p>In PDF Document Maker, we use the custom tag <code>&lt;diagrams-plantuml&gt;</code> to insert a PlantUML diagram.</p>
<p>It looks like this:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 46. Referencing an external PlantUML diagram</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">diagrams-plantuml</span> <span class="hljs-attr">input-file</span>=<span class="hljs-string">&quot;img/activity-1.puml&quot;</span>
    <span class="hljs-attr">output-file</span>=<span class="hljs-string">&quot;activity-1.png&quot;</span> <span class="hljs-attr">tpng</span>/&gt;</span>
</code></pre>
</div>
</div>
<p>The above diagram, in this case, is saved in the file <code>activity-1.puml</code> in the <code>img</code> subdirectory.  The file is read in, and passed to PlantUML for rendering.</p>
<p>That renders as so:</p>
<p>
        <figure>
        <img src="activity-1.png">
        
        </figure>
        </p>
<p>The rendered version is an <code>&lt;img&gt;</code> tag with a <code>src</code> attribute referencing the file named in the <code>output-file</code> attribute.</p>
<p>To render it as SVG replace <code>tpng</code> with <code>tsvg</code>.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 47. Rendering a PlantUML diagram to SVG</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">diagrams-plantuml</span> <span class="hljs-attr">input-file</span>=<span class="hljs-string">&quot;img/activity-1.puml&quot;</span>
    <span class="hljs-attr">output-file</span>=<span class="hljs-string">&quot;activity-1.svg&quot;</span> <span class="hljs-attr">tsvg</span>/&gt;</span>
</code></pre>
</div>
</div>
<p>That renders as so:</p>
<p>
        <figure>
        <img src="activity-1.svg">
        
        </figure>
        </p>
<p>Both <code>tsvg</code> and <code>tpng</code> are properties, not attributes, and they should be used in this way without an attribute value.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 47. An in-line a PlantUML diagram</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">diagrams-plantuml</span>
      <span class="hljs-attr">output-file</span>=<span class="hljs-string">&quot;activity-1-inline.png&quot;</span> <span class="hljs-attr">tpng</span>&gt;</span>
@startuml

start

if (Graphviz installed?) then (yes)
  :process all
   diagrams;
else (no)
  :process only
  __sequence__ and __activity__ diagrams;
endif

stop

@enduml
<span class="hljs-tag">&lt;/<span class="hljs-name">diagrams-plantuml</span>&gt;</span>
</code></pre>
</div>
</div>
<p>Which renders as so:</p>

        <figure>
        <img src="activity-1-inline.png">
        
        </figure>
        <p></p>
<p>In this case no <code>input-file</code> is given.  Instead, the input comes from the element body.</p>
</section>
<section>
<h2>Using MermaidJS diagrams in PDF Document Maker</h2>
<p>Mermaid - <a href="https://mermaid.js.org/"><code>https://mermaid.js.org/</code></a> - is similar to PlantUML.  It supports a variety of diagrams, mostly in the UML bailiwick.  One creates a textual description o the diagram, pasting it into a Markdown document.</p>
<p>Unlike with PlantUML we were unable to integrate Mermaid such that a code block with the <code>mermaid</code> class would be automatically rendered as an inline SVG.</p>
<p>The most convenient path is to install Mermaid-CLI - <a href="https://github.com/mermaid-js/mermaid-cli"><code>https://github.com/mermaid-js/mermaid-cli</code></a></p>
<p>In your project directory do this:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 48. Installing the Mermaid CLI tool</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npm install @mermaid-js/mermaid-cli --save</span>
</code></pre>
</div>
</div>
<p>This installs a program you can run as so:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 49. The Mermaid CLI options</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npx mmdc --<span class="hljs-built_in">help</span></span>
Usage: mmdc [options]

Options:
  -V, --version                                   output the version number
  -t, --theme [theme]                             Theme of the chart (choices: &quot;default&quot;, &quot;forest&quot;, &quot;dark&quot;, &quot;neutral&quot;,
                                                  default: &quot;default&quot;)
  -w, --width [width]                             Width of the page (default: 800)
  -H, --height [height]                           Height of the page (default: 600)
  -i, --input &lt;input&gt;                             Input mermaid file. Files ending in .md will be treated as Markdown
                                                  and all charts (e.g. ```mermaid (...)``` or :::mermaid (...):::)
                                                  will be extracted and generated. Use `-` to read from stdin.
  -o, --output [output]                           Output file. It should be either md, svg, png, pdf or use `-` to
                                                  output to stdout. Optional. Default: input + &quot;.svg&quot;
  -e, --outputFormat [format]                     Output format for the generated image. (choices: &quot;svg&quot;, &quot;png&quot;,
                                                  &quot;pdf&quot;, default: Loaded from the output file extension)
  -b, --backgroundColor [backgroundColor]         Background color for pngs/svgs (not pdfs). Example: transparent,
                                                  red, &apos;#F0F0F0&apos;. (default: &quot;white&quot;)
  -c, --configFile [configFile]                   JSON configuration file for mermaid.
  -C, --cssFile [cssFile]                         CSS file for the page.
  -I, --svgId [svgId]                             The id attribute for the SVG element to be rendered.
  -s, --scale [scale]                             Puppeteer scale factor (default: 1)
  -f, --pdfFit                                    Scale PDF to fit chart
  -q, --quiet                                     Suppress log output
  -p --puppeteerConfigFile [puppeteerConfigFile]  JSON configuration file for puppeteer.
  -h, --help                                      display help for command
</code></pre>
</div>
</div>
<p>A sample Mermaid diagram is:</p>
<pre><code class="hljs">
stateDiagram-v2
<span class="hljs-built_in">title</span>: Simple sample

    [*] --&gt; Still
    S<span class="hljs-function"><span class="hljs-title">till</span> --&gt;</span> [*]

    S<span class="hljs-function"><span class="hljs-title">till</span> --&gt;</span> Moving
    M<span class="hljs-function"><span class="hljs-title">oving</span> --&gt;</span> Still
    M<span class="hljs-function"><span class="hljs-title">oving</span> --&gt;</span> Crash
    C<span class="hljs-function"><span class="hljs-title">rash</span> --&gt;</span> [*]</code></pre>
<p>This must be saved as a separate file in the file-system.  For example, a subdirectory <code>img</code> is a useful place to store images.  In that case, save the text in a file <code>./img/simple-sample-1.mmd</code>.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 50. Rendering a Mermaid diagram with the CLI</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-shell">npx mmdc -i documents/guide/img/simple-sample-1.mmd \
  -o documents/guide/img/simple-sample-1.svg \
  --outputFormat svg
</code></pre>
</div>
</div>
<p>The <code>-i</code> option specifies the input file, and <code>-o</code> the output file.  Hence, this converts to an output file in the same directory the SVG version of the diagram.</p>
<p>The result looks like so:</p>
<figure>
  <img width="300px" src="./img/simple-sample-1.svg">
  <figcaption>Simple Sample 1</figcaption>
</figure>
<!-- These were attempts to rein in the size of that image -->
<!-- img figure src="./img//simple-sample-1.svg"
  caption="Simple Sample 1"
  width="700px"/ -->
<!-- ![Simple Sample 1](./img/simple-sample-1.svg) -->
<p>Let&apos;s talk a little about rendering SVG images in HTML.  SVG is a vector image format, meaning that an SVG file contains commands for drawing lines and circles and the like.  It also means SVG files do not have a defined width/height, unlike pixel image formats.  Therefore SVG files can scale to any amount with no pixelation.</p>
<p>Initially, as a result, this image filled an entire page in the PDF file.</p>
<p>One way to give an SVG file a size is by editing the SVG to set <code>width=</code>, <code>height=</code> and other parameters.  But the simplest way is to use HTML directly like so:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 51. Using <code>&lt;figure&gt;/&lt;img&gt;</code> with an SVG file</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">figure</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;300px&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./img/simple-sample-1.svg&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">figcaption</span>&gt;</span>Simple Sample 1<span class="hljs-tag">&lt;/<span class="hljs-name">figcaption</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">figure</span>&gt;</span>
</code></pre>
</div>
</div>
<p>This <code>&lt;img&gt;</code> is displaying the SVG, and is defined with a <code>300 pixel</code> width.  The SVG then renders to that size.</p>
<p>Next is to automate building the images before building the document.  Earlier we went over using the <code>scripts</code> tag in <code>package.json</code>.  Let&apos;s add to that workflow.</p>
<p>First, add a command to build each Mermaid file:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 52. Mermaid build procedure</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-json"><span class="hljs-attr">&quot;build:sample-1&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;npx mmdc -i documents/guide/simple-sample-1.mmd -o documents/guide/simple-sample-1.svg --outputFormat svg&quot;</span><span class="hljs-punctuation">,</span>
<span class="hljs-attr">&quot;build:guide&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;npm-run-all build:sample-1 build:render&quot;</span><span class="hljs-punctuation">,</span>
</code></pre>
</div>
</div>
<p>We take the same command, and add it to the script.  The tag name format is <code>build:file-name</code>.</p>
<p>The <code>build:guide</code> script contains the complete build procedure.</p>
<p>The resulting SVG file can be referenced from Markdown using:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 53. Using the SVG file in Markdown</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs">!<span class="hljs-selector-attr">[Simple Sample 1]</span>(./<span class="hljs-selector-tag">img</span>/simple-sample-<span class="hljs-number">1</span><span class="hljs-selector-class">.svg</span>)
</code></pre>
</div>
</div>
<p>This is a normal Markdown image tag which will contain the alt-text <em>Simple Sample 1</em>.</p>
<p>But, if you have multiple files to render it&apos;s more efficient to use the Mermaid CLI API in a script like this:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 54. JS Script to build several Mermaid diagrams</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> { run } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@mermaid-js/mermaid-cli&quot;</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;.../img/mahabhuta-workflow.mmd&quot;</span>);
<span class="hljs-keyword">await</span> <span class="hljs-title function_">run</span>(
   <span class="hljs-string">&quot;./documents/guide/img/mahabhuta-workflow.mmd&quot;</span>,
   <span class="hljs-string">&quot;./documents/guide/img/mahabhuta-workflow.svg&quot;</span>,
);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;.../img/pdf-document-workflow.mmd&quot;</span>);
<span class="hljs-keyword">await</span> <span class="hljs-title function_">run</span>(
    <span class="hljs-string">&quot;./documents/guide/img/pdf-document-workflow.mmd&quot;</span>,
    <span class="hljs-string">&quot;./documents/guide/img/pdf-document-workflow.svg&quot;</span>,
);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;.../img/simple-sample-1.mmd&quot;</span>);
<span class="hljs-keyword">await</span> <span class="hljs-title function_">run</span>(
    <span class="hljs-string">&quot;./documents/guide/img/simple-sample-1.mmd&quot;</span>,
    <span class="hljs-string">&quot;./documents/guide/img/simple-sample-1.svg&quot;</span>,
);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;.../img/simple-sample-2.mmd&quot;</span>);
<span class="hljs-keyword">await</span> <span class="hljs-title function_">run</span>(
    <span class="hljs-string">&quot;./documents/guide/img/simple-sample-2.mmd&quot;</span>,
    <span class="hljs-string">&quot;./documents/guide/img/simple-sample-2.svg&quot;</span>,
);
</code></pre>
</div>
</div>
<p>This should save the time required to initialize Puppeteer four times.</p>
<section>
<h3>Diagnosing a &quot;<em>Failed to launch the browser</em>&quot; failure with Mermaid</h3>
<p>The following might happen when you run the Mermaid CLI tool:</p>
<pre><code class="hljs language-shell">./documents/guide/img/mahabhuta-workflow.mmd
Generating single mermaid chart
file:///home/david/Projects/akasharender/pdf-document-construction-set/guide/node_modules/@puppeteer/browsers/lib/esm/launch.js:303
                reject(new Error([
                       ^

Error: Failed to launch the browser process!
[254374:254374:0128/141251.817539:FATAL:zygote_host_impl_linux.cc(128)] No usable sandbox! If you are running on Ubuntu 23.10+ or another Linux distro that has disabled unprivileged user namespaces with AppArmor, see https://chromium.googlesource.com/chromium/src/+/main/docs/security/apparmor-userns-restrictions.md. Otherwise see https://chromium.googlesource.com/chromium/src/+/main/docs/linux/suid_sandbox_development.md for more information on developing with the (older) SUID sandbox. If you want to live dangerously and need an immediate workaround, you can try using --no-sandbox.

TROUBLESHOOTING: https://pptr.dev/troubleshooting
</code></pre>
<p>The issue here is that Mermaid uses Puppeteer which in turn uses a Chrome instance for rendering files to PDF, and Chrome&apos;s security requires sandboxing its execution.</p>
<p>The Puppeteer troubleshooting page explains what to do.  The first presented option is to turn off the sandboxing with the <code>--no-sandbox</code> option.  The Mermaid CLI doesn&apos;t offer a way to do this, and it&apos;s a bad idea anyway.</p>
<p>What does work is to chdir to <code>~/.cache/puppeteer/chrome/linux-&lt;version&gt;/chrome-linux64/</code> (notice the version number) and run the commands listed in the troubleshooting guide.  This creates a setuid sandbox.  Because Chrome is routinely updated, you may have to rerun these commands from time to time.</p>
<p>Also, review the guidance for running Puppeteer in build systems like Travis CI, or in Docker.  In some cases PDF Document Maker will be used in an automated build system, which will require some environment preparation as outlined in that documentation.</p>
</section>
</section>
<section>
<h2>High quality equation (mathematical and chemical) rendering with KaTeX</h2>
<p>KaTeX is a LaTeX/TeX-inspired format for rendering beautiful mathematical equations.  Like with PlantUML and Mermaid, the model is to describe math equations in a textual format, which is rendered by KaTeX into the equations written by real mathematicians.</p>
<p>For example, take this</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 55. A simple KaTeX expression</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs">\<span class="hljs-built_in">sqrt</span>{<span class="hljs-number">3</span><span class="hljs-variable language_">x</span><span class="hljs-number">-1</span>}+(<span class="hljs-number">1</span>+<span class="hljs-variable language_">x</span>)^<span class="hljs-number">2</span>
</code></pre>
</div>
</div>
<p>This is describing the square-root of <code>3x-1</code> plus <code>1+x</code> squared.</p>
<p>In a Markdown document, the KaTeX string is surrounded with dollar signs like so:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 56. Using a KaTeX expression in Markdown</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs"><span class="hljs-symbol">&#x24;</span>\<span class="hljs-built_in">sqrt</span>{<span class="hljs-number">3</span>x<span class="hljs-number">-1</span>}+(<span class="hljs-number">1</span>+x)^<span class="hljs-number">2</span><span class="hljs-symbol">&#x24;</span>
</code></pre>
</div>
</div>
<p>Which is then rendered this way:</p>
<p><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><mn>3</mn><mi>x</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msqrt><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sqrt{3x-1}+(1+x)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1744em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8656em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">3</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span><span style="top:-2.8256em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.1744em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></eq></p>
<p>And, the equation can be put in the middle of a sentence, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><mn>3</mn><mi>x</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msqrt><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sqrt{3x-1}+(1+x)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1744em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8656em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">3</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span><span style="top:-2.8256em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.1744em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></eq>, like so.  This of course must be used carefully because a large equation might not look very good in the middle of a paragraph.  This particular equation is about the same visual height as the line of text, which leaves the paragraph remaining to look normal.</p>
<p>While simple equations like <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">n!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span></span></eq> or <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">y^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></eq> renders nicely in a paragraph, a larger equation like <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>a</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>b</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>d</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}    a &amp; b \\    c &amp; d \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">c</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></eq> is unlikely to work when placed in-line with text in a paragraph.  The issue has to do with the visual height of the taller equation in contrast to the height of text lines.</p>
<p>Here&apos;s some examples of taller equations displayed between paragraphs:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 57. Block-style KaTeX expression examples</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs"><span class="hljs-variable">&#x24;&#x24;</span>\<span class="hljs-keyword">begin</span>{gather}
   a=b \\
   e=b+c
\<span class="hljs-keyword">end</span>{gather}<span class="hljs-variable">&#x24;&#x24;</span>

<span class="hljs-variable">&#x24;&#x24;</span>\<span class="hljs-keyword">begin</span>{CD}
   A @&gt;a&gt;&gt; B \\
<span class="hljs-variable">@VbVV</span> <span class="hljs-variable">@AAcA</span> \\
   C @= D
\<span class="hljs-keyword">end</span>{CD}<span class="hljs-variable">&#x24;&#x24;</span>

<span class="hljs-variable">&#x24;&#x24;</span>\<span class="hljs-keyword">begin</span>{equation}
  \<span class="hljs-keyword">begin</span>{pmatrix}
    A &amp; B \\ B &amp; C
  \<span class="hljs-keyword">end</span>{pmatrix} 
\<span class="hljs-keyword">end</span>{equation}<span class="hljs-variable">&#x24;&#x24;</span>
</code></pre>
</div>
</div>
<p>Which renders as:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="center" columnspacing="0em"><mtr><mtd class="mtr-glue"/><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>a</mi><mo>=</mo><mi>b</mi></mrow></mstyle></mtd><mtd class="mtr-glue"/><mtd class="mml-eqn-num"/></mtr><mtr><mtd class="mtr-glue"/><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>e</mi><mo>=</mo><mi>b</mi><mo>+</mo><mi>c</mi></mrow></mstyle></mtd><mtd class="mtr-glue"/><mtd class="mml-eqn-num"/></mtr></mtable><annotation encoding="application/x-tex">\begin{gather}
   a=b \\
   e=b+c
\end{gather}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">b</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">c</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="eqn-num"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></eqn></section><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="center center center" columnspacing="0.5em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><munderover><mo stretchy="true" minsize="3.0em">&#x2192;</mo><mpadded width="+0.6em" lspace="0.3em"><mrow/></mpadded><mpadded width="+0.6em" lspace="0.3em"><mi>a</mi></mpadded></munderover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>B</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mstyle displaystyle="false" scriptlevel="1"><mpadded width="0" lspace="-1width" voffset="0.7em"><mrow><mi>b</mi></mrow></mpadded></mstyle><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">&#x2193;</mo><mstyle displaystyle="false" scriptlevel="1"><mpadded width="0" voffset="0.7em"><mrow><mrow/></mrow></mpadded></mstyle></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"/></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mstyle displaystyle="false" scriptlevel="1"><mpadded width="0" lspace="-1width" voffset="0.7em"><mrow><mrow/></mrow></mpadded></mstyle><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">&#x2191;</mo><mstyle displaystyle="false" scriptlevel="1"><mpadded width="0" voffset="0.7em"><mrow><mi>c</mi></mrow></mpadded></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>C</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mover><mo stretchy="true" minsize="3.0em">=</mo><mpadded width="+0.6em" lspace="0.3em"/></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>D</mi></mstyle></mtd></mtr><mtr/></mtable><annotation encoding="application/x-tex">\begin{CD}
   A @&gt;a&gt;&gt; B \\
@VbVV @AAcA \\
   C @= D
\end{CD}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.3053em;vertical-align:-1.6062em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6992em;"><span style="top:-5.9268em;"><span class="pstrut" style="height:3.151em;"></span><span class="mord mathnormal">A</span></span><span style="top:-4.0879em;"><span class="pstrut" style="height:3.151em;"></span><span class="mord cd-vert-arrow"><span class="sizing reset-size6 size3 mtight cd-label-left" style="bottom:0.8em;"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span><span class="mord"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.151em;"><span style="top:-1.966em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>&#x2193;</span></span></span><span style="top:-2.558em;"><span class="pstrut" style="height:2.616em;"></span><span style="height:0.616em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.616em" style="width:0.6667em" viewBox="0 0 666.67 616" preserveAspectRatio="xMinYMin"><path d="M312 0 H355 V616 H312z M312 0 H355 V616 H312z"/></svg></span></span><span style="top:-3.166em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>&#x23d0;</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="sizing reset-size6 size3 mtight cd-label-right" style="bottom:0.8em;"><span class="mord mtight"></span></span></span></span><span style="top:-2.2327em;"><span class="pstrut" style="height:3.151em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:1.6062em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.25em;"></span><span class="arraycolsep" style="width:0.25em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6992em;"><span style="top:-5.9268em;"><span class="pstrut" style="height:3.151em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9234em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight cd-arrow-pad"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:3em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span><span style="top:-2.578em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight cd-arrow-pad"><span class="mord mtight"></span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.122em;"><span></span></span></span></span></span></span><span style="top:-4.0879em;"><span class="pstrut" style="height:3.151em;"></span></span><span style="top:-2.2327em;"><span class="pstrut" style="height:3.151em;"></span><span class="mrel x-arrow"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.528em;"><span style="top:-2.862em;"><span class="pstrut" style="height:2.334em;"></span><span class="cd-arrow-pad"></span></span><span class="svg-align" style="top:-2.417em;"><span class="pstrut" style="height:2.334em;"></span><span class="hide-tail" style="height:0.334em;min-width:3em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.334em" viewBox="0 0 400000 334" preserveAspectRatio="xMinYMin slice"><path d="M0 50 h400000 v40H0z m0 194h40000v40H0z
M0 50 h400000 v40H0z m0 194h40000v40H0z"/></svg></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:1.6062em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.25em;"></span><span class="arraycolsep" style="width:0.25em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6992em;"><span style="top:-5.9268em;"><span class="pstrut" style="height:3.151em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-4.0879em;"><span class="pstrut" style="height:3.151em;"></span><span class="mord cd-vert-arrow"><span class="sizing reset-size6 size3 mtight cd-label-left" style="bottom:0.8em;"><span class="mord mtight"></span></span><span class="mord"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.151em;"><span style="top:-1.966em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>&#x23d0;</span></span></span><span style="top:-2.559em;"><span class="pstrut" style="height:2.616em;"></span><span style="height:0.616em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.616em" style="width:0.6667em" viewBox="0 0 666.67 616" preserveAspectRatio="xMinYMin"><path d="M312 0 H355 V616 H312z M312 0 H355 V616 H312z"/></svg></span></span><span style="top:-3.167em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>&#x2191;</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="sizing reset-size6 size3 mtight cd-label-right" style="bottom:0.8em;"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span style="top:-2.2327em;"><span class="pstrut" style="height:3.151em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:1.6062em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"/><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">(</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>B</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>C</mi></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mstyle></mtd><mtd class="mtr-glue"/><mtd class="mml-eqn-num"/></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
  \begin{pmatrix}
    A &amp; B \\ B &amp; C
  \end{pmatrix} 
\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.45em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.45em;"><span class="pstrut" style="height:3.45em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">&#x200b;</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span></span></eqn></section><p>The difference is that the delimiters <code>&#x24; .. &#x24;</code> are for inline equations, while <code>&#x24;&#x24; .. &#x24;&#x24;</code> are for what&apos;s called &quot;block&quot; or &quot;display&quot; rendering.</p>
<p>This also supports the <em>mhchem</em> extension for KaTeX which supports writing chemistry equations:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 58. Example chemical expressions</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs">&#x24;\<span class="hljs-function"><span class="hljs-title">ce</span>{CO2 + C -&gt;</span> <span class="hljs-number">2</span> CO}&#x24;

&#x24;\<span class="hljs-function"><span class="hljs-title">ce</span>{Hg^2+ -&gt;</span>[I-] H<span class="hljs-function"><span class="hljs-title">gI2</span> -&gt;</span>[I-] [Hg^{II}I4]^<span class="hljs-number">2</span>-}&#x24;

&#x24;\<span class="hljs-function"><span class="hljs-title">ce</span>{A -&gt;</span> B}&#x24;

&#x24;\<span class="hljs-function"><span class="hljs-title">ce</span>{A -&gt;</span>[H2O] B}&#x24;

&#x24;\<span class="hljs-function"><span class="hljs-title">ce</span>{A -&gt;</span>[{<span class="hljs-keyword">text</span> above}][{<span class="hljs-keyword">text</span> below}] B}&#x24;
</code></pre>
</div>
</div>
<!-- This does not work:

$$\ce{$K = \ce{\frac{[Hg^2+][Hg]}{[Hg2^2+]}}$}$$

-->
<p>Those are rendered as:</p>
<p><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#cc0000"><mtext>\ce</mtext></mstyle><mrow><mi>C</mi><mi>O</mi><mn>2</mn><mo>+</mo><mi>C</mi><mo>&#x2212;</mo><mo>&gt;</mo><mn>2</mn><mi>C</mi><mi>O</mi></mrow></mrow><annotation encoding="application/x-tex">\ce{CO2 + C -&gt; 2 CO}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text" style="color:#cc0000;"><span class="mord" style="color:#cc0000;">\ce</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">CO</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord">&#x2212;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em;">CO</span></span></span></span></span></eq></p>
<p><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#cc0000"><mtext>\ce</mtext></mstyle><mrow><mi>H</mi><msup><mi>g</mi><mn>2</mn></msup><mo>+</mo><mo>&#x2212;</mo><mo>&gt;</mo><mo stretchy="false">[</mo><mi>I</mi><mo>&#x2212;</mo><mo stretchy="false">]</mo><mi>H</mi><mi>g</mi><mi>I</mi><mn>2</mn><mo>&#x2212;</mo><mo>&gt;</mo><mo stretchy="false">[</mo><mi>I</mi><mo>&#x2212;</mo><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>H</mi><msup><mi>g</mi><mrow><mi>I</mi><mi>I</mi></mrow></msup><mi>I</mi><mn>4</mn><msup><mo stretchy="false">]</mo><mn>2</mn></msup><mo>&#x2212;</mo></mrow></mrow><annotation encoding="application/x-tex">\ce{Hg^2+ -&gt;[I-] HgI2 -&gt;[I-] [Hg^{II}I4]^2-}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord text" style="color:#cc0000;"><span class="mord" style="color:#cc0000;">\ce</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">&#x2212;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">&#x2212;</span><span class="mclose">]</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">2</span><span class="mord">&#x2212;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">&#x2212;</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">II</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">4</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">&#x2212;</span></span></span></span></span></eq></p>
<p><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#cc0000"><mtext>\ce</mtext></mstyle><mrow><mi>A</mi><mo>&#x2212;</mo><mo>&gt;</mo><mi>B</mi></mrow></mrow><annotation encoding="application/x-tex">\ce{A -&gt; B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text" style="color:#cc0000;"><span class="mord" style="color:#cc0000;">\ce</span></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord">&#x2212;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></eq></p>
<p><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#cc0000"><mtext>\ce</mtext></mstyle><mrow><mi>A</mi><mo>&#x2212;</mo><mo>&gt;</mo><mo stretchy="false">[</mo><mi>H</mi><mn>2</mn><mi>O</mi><mo stretchy="false">]</mo><mi>B</mi></mrow></mrow><annotation encoding="application/x-tex">\ce{A -&gt;[H2O] B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text" style="color:#cc0000;"><span class="mord" style="color:#cc0000;">\ce</span></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord">&#x2212;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mclose">]</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></eq></p>
<p><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#cc0000"><mtext>\ce</mtext></mstyle><mrow><mi>A</mi><mo>&#x2212;</mo><mo>&gt;</mo><mo stretchy="false">[</mo><mrow><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi>a</mi><mi>b</mi><mi>o</mi><mi>v</mi><mi>e</mi></mrow><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mrow><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi>b</mi><mi>e</mi><mi>l</mi><mi>o</mi><mi>w</mi></mrow><mo stretchy="false">]</mo><mi>B</mi></mrow></mrow><annotation encoding="application/x-tex">\ce{A -&gt;[{text above}][{text below}] B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text" style="color:#cc0000;"><span class="mord" style="color:#cc0000;">\ce</span></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord">&#x2212;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ab</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span></span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span><span class="mclose">]</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></eq></p>
<p>References:</p>
<ul>
<li><a href="https://www.npmjs.com/package/markdown-it-texmath">https://www.npmjs.com/package/markdown-it-texmath</a></li>
<li><a href="https://katex.org/">https://katex.org/</a></li>
<li><a href="https://mhchem.github.io/MathJax-mhchem/">https://mhchem.github.io/MathJax-mhchem/</a></li>
</ul>
<p>This feature can be disabled using the <code>--no-md-katex</code> option.</p>
</section>
</section>
<section>
<h1>Custom HTML tags and custom HTML processing</h1>
<p>The AkashaCMS <sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> contains the Mahabhuta engine <sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> which handles custom DOM processing, server-side, using a jQuery-like API.  The workflow diagram later includes these steps:</p>
<figure>
  <img class="max-w-100" max-width="100%" src="./img/mahabhuta-workflow.svg">
  <figcaption>DOM Processing workflow</figcaption>
</figure>
<p>In Mahabhuta, we design individual functions (called Mahafuncs) each of which perform a specific DOM manipulation.</p>
<p>For example, we discussed earlier the custom attributes we can use with <code>&lt;img&gt;</code> tags.  Those attributes are processed by a Mahafunc within the AkashaRender package.</p>
<p>Part of an AkashaCMS project configuration can specify the custom DOM processing functions which will be available.  The <em>use Mahabhuta for custom DOM processing</em> step means to take the HTML resulting from rendering the document into the layout template, and running every Mahafunc against the HTML.</p>
<p>Most of the Mahafuncs have a jQuery-like selector determining whether to run the Mahafunc.  If the selector says to execute the function, its <code>process</code> method is called, and it performs whatever manipulations it is programmed for.</p>
<p>Full Mahabhuta documentation is at: <a href="https://akashacms.com/mahabhuta/toc.html"><code>https://akashacms.com/mahabhuta/toc.html</code></a></p>
<p>In PDF Document Maker, the <code>--funcs &lt;funcsFN&gt;</code> parameter allows us to supply a JavaScript file containing a <code>Mahafuncarray</code>.</p>
</section>
<section>
<h1>Generating a table of contents, automating section numbering</h1>
<p>That discussion of Mahabhuta functions needs a practical demonstration.  For that purpose, let&apos;s go over a method of adding section numbers to header tags, and creating a Table of Contents from the header tags.</p>
<p>In the Markdown-IT ecosystem, some plugins promise to create a Table of Contents.  But they did not work well in testing.  Instead the following technique was developed.</p>
<p>The code for this is in the PDF Document Maker website, in the <code>guide</code> directory.  The file, <code>mahafuncs.mjs</code>, contains a <code>MahafuncArray</code> containing a Mahafunc named <code>HnNumbering</code>.</p>
<p>In a Node.js module exporting a MahafuncArray, it must have a function like this:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 59. Declaring a Mahabhuta Array</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> pluginName = <span class="hljs-string">&apos;PDF-Document-Maker-Guide&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">mahabhutaArray</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-keyword">let</span> ret = <span class="hljs-keyword">new</span> mahabhuta.<span class="hljs-title class_">MahafuncArray</span>(pluginName, options);
    ret.<span class="hljs-title function_">addMahafunc</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HnNumbering</span>());
    <span class="hljs-keyword">return</span> ret;
};
</code></pre>
</div>
</div>
<p>This function is executed from PDF Document Maker.  It creates a MahafuncArray, adds instances of Mahafuncs, returning the array.  The array is then added into the Configuration.</p>
<p>When the Mahabhuta stage runs, it simply steps through each MahafuncArray, executing every Mahafunc array it contains.</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 60. Declaring a Mahabhuta class</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HnNumbering</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">mahabhuta.PageProcessor</span> {
	<span class="hljs-keyword">async</span> <span class="hljs-title function_">process</span>(&#x24;, metadata, dirty) <span class="hljs-comment">/* : Promise&lt;string&gt; */</span> {
    <span class="hljs-comment">// ...</span>
  }
}
</code></pre>
</div>
</div>
<p>The <code>PageProcessor</code> class is for Mahafuncs which can access anything on the page.  It does not have the <code>selector</code> function discussed earlier, and therefore this <code>process</code> function will always be executed.</p>
<p>The <code>&#x24;</code> parameter is a jQuery-like <code>&#x24;</code> object.  It has most of the jQuery methods, allowing one to search around the page and make manipulations mostly like you&apos;d do with jQuery in a browser.</p>
<p>Because the Mahafuncs are exected after the HTML is rendered, the DOM held by the <code>&#x24;</code> object is what&apos;s about to be written as the final HTML.  This is our chance to customize that HTML.</p>
<p>This particular function loops over all H1, H2, and H3 tags like so:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 61. Looping over HTML in a Mahabhuta function</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-js">&#x24;(<span class="hljs-string">&apos;article&apos;</span>).<span class="hljs-title function_">find</span>(<span class="hljs-string">&apos;h1:not(.header-title), h2, h3&apos;</span>).<span class="hljs-title function_">each</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
});
</code></pre>
</div>
</div>
<p>What happens inside this loop is a little hairy, but one key part is to add a section number to the H1/2/3 tag like so:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 62. Modifying Hn tags</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> title = <span class="hljs-string">`<span class="hljs-subst">&#x24;{counter_h1}</span>.<span class="hljs-subst">&#x24;{counter_h2}</span>.<span class="hljs-subst">&#x24;{counter_h3}</span>. <span class="hljs-subst">&#x24;{&#x24;(<span class="hljs-variable language_">this</span>).text()}</span>`</span>;
&#x24;(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">text</span>(title);
</code></pre>
</div>
</div>
<p>That loop also constructs a data structure of the H1/2/3 tags, formatting it into a UL/LI list using this partial template:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 63. Generating the Table of Contents</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> toctext = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">array</span>.<span class="hljs-property">options</span>.<span class="hljs-property">akasha</span>.<span class="hljs-title function_">partial</span>(
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">array</span>.<span class="hljs-property">options</span>.<span class="hljs-property">config</span>,
    <span class="hljs-string">&apos;toc.html.njk&apos;</span>, {
    headers
});
</code></pre>
</div>
</div>
<p>Once the UL/LI list is constructed, the tag <code>&lt;toc-text-here&gt;</code> is replaced with that list like so:</p>
<div class="card">
<div class="card-title">
<p><strong>Figure 64. Inserting the Table of Contents into the document</strong></p>
</div>
<div class="card-body">
<pre><code class="hljs language-js">&#x24;(<span class="hljs-string">&apos;toc-text-here&apos;</span>).<span class="hljs-title function_">replaceWith</span>(toctext);
</code></pre>
</div>
</div>
<p>The PDF version of this document you&apos;re reading has section numbering, and a table of contents, generated by that function.</p>
</section>
<section>
<h1>PDF Document Maker inner workflow</h1>
<p>This diagram may help you understand what&apos;s happening.</p>
<figure>
  <img class="max-w-100" max-width="100%" src="./img/pdf-document-workflow.svg">
  <figcaption>PDF Document Maker workflow</figcaption>
</figure>
<h1 class="mt-3">Footnotes</h1>
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>This is the body of the footnote. <a href="#fnref1" class="footnote-backref">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn2" class="footnote-item"><p>In Sanskrit, <em>Akasha</em> is the underlying stuff from which the universe is made. <a href="#fnref2" class="footnote-backref">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn3" class="footnote-item"><p><em>Mahabhuta</em> relates to the five elements.  Hence, the Mahabhuta engine handles HTML element processing, while AkashaCMS helps writers build their website. <a href="#fnref3" class="footnote-backref">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>
</section>

  </article>
</div>

<footer class="row" style="text-align: center; height: 100px;">
<div class="col-sm-12">
<div class="row">
    <hr>
    <div class="card">
        <div class="card-body">
            <p>&quot;PDF&quot; is the name for a file format developed by Adobe.  It&apos;s possible Adobe has a trademark on &quot;PDF&quot;.  The USPTO list of trademarks shows close to a zillion applications with the string &quot;PDF&quot; in the name.  Therefore, it is believed that &quot;PDF&quot; in &quot;PDF Document Maker&quot; is under fair use.</p>
        </div>
    </div>
    <div class="card">
        <div class="card-body">
            <p><a href="https://akashacms.github.io/pdf-document-construction-set/">PDF Document Maker</a> is an application built on top of <a href="https://akashacms.com">AkashaCMS</a> components.</p>
        </div>
    </div>
</div>
<!-- partial file-name="footer.html"></partial></div -->
</div></footer>
</div>


<script src="../vendor/jquery/jquery.min.js"></script><script src="../vendor/bootstrap/js/bootstrap.min.js"></script>


</body>
</html>

